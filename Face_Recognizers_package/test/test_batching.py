import os
import cv2
import numpy as np
from face_recognizers import Recognizer
from face_recognizers import DataBase
from face_detectors import Detector
from face_detectors import FaceAlign
import time
from scipy.spatial.distance import cdist


data_path = "./test/assets/players/"

recognizer = Recognizer("pedestrian")
recognizer.set_device("gpu")
dummy_input = np.random.rand(1,112,112,3).astype(np.float32)
recognizer.predict(dummy_input)
fdetector = Detector("retinaface_large")
falign = FaceAlign()

# dynamic batching in parallel
image_files = [file for file in os.listdir(data_path) if file.endswith((".jpg", ".jpeg", ".png"))]
images = [cv2.imread(os.path.join(data_path, file)) for file in image_files]
# images = [images[0]]

aligned_images = [falign.align(image, fdetector.predict(image)["landmarks"][0]) for image in images] *50

image_tensor = np.array(aligned_images)
print(image_tensor.shape)


start_time = time.time()
face = recognizer.predict(image_tensor)
processing_time_ms = (time.time() - start_time) * 1000  # Convert to milliseconds
print(f"Processing time: {processing_time_ms:.2f} ms")


encode0 = [[ 0.02910087,  0.02078015, -0.00744705,  0.00371643, -0.08284754,
         0.04101614, -0.01402378, -0.03661961, -0.03349657, -0.11388152,
        -0.07046537, -0.01945172,  0.02842648, -0.01946339,  0.01951069,
         0.02791062, -0.02692633,  0.01057266, -0.00160212, -0.06678453,
        -0.08042654, -0.08057307,  0.05859249, -0.04547532, -0.03838889,
         0.05212789, -0.00620905,  0.00640619, -0.03629055,  0.01177608,
         0.02713834,  0.00878658, -0.04841029,  0.03534304, -0.01574908,
         0.05231172, -0.01398244,  0.0473665 ,  0.07370973, -0.08575275,
         0.03318047,  0.02910253,  0.01023793,  0.06099965, -0.09536585,
        -0.03489248,  0.05486197,  0.06807963,  0.03070981,  0.02209374,
         0.00487052,  0.03949139, -0.00100529, -0.03119236, -0.00722913,
        -0.00874568, -0.01977387, -0.01462587,  0.07296438,  0.01478056,
        -0.00382917,  0.01770139, -0.09828221,  0.01379382, -0.0424708 ,
         0.04175146,  0.04469723, -0.05323736, -0.02942517, -0.01224231,
         0.02092716, -0.02351391, -0.00272487,  0.04807922,  0.07714809,
         0.06254639, -0.0384696 ,  0.00853876,  0.00185878,  0.02196683,
         0.07921233,  0.0441226 , -0.03277727,  0.00711621, -0.03442247,
        -0.01352962,  0.0096426 , -0.07576703, -0.03285145, -0.06539305,
        -0.10620388,  0.03996768,  0.04313058,  0.03435526, -0.00176762,
         0.01451268, -0.00621623,  0.04591839,  0.01116111,  0.09209491,
         0.04365401, -0.00497142, -0.13101935, -0.02956622, -0.00752089,
        -0.0567541 ,  0.02388222, -0.00301221,  0.00272665, -0.09850156,
         0.01996416, -0.0430872 , -0.030425  ,  0.01417164,  0.04729214,
         0.04712833, -0.08486623, -0.04043467,  0.04371389,  0.01012154,
         0.04605005,  0.03107594,  0.03707024, -0.0785138 ,  0.00206795,
        -0.04494596,  0.11617788, -0.03184398,  0.05980984,  0.01550183,
        -0.01029287,  0.01477167, -0.06723835, -0.00585432, -0.02039745,
         0.02504518, -0.03516198,  0.00134896, -0.02409566,  0.05902276,
        -0.05136135,  0.0104304 , -0.02549127, -0.01266036,  0.00578408,
         0.04077521,  0.00502346, -0.05395017, -0.0513248 , -0.00119317,
        -0.09158548, -0.01396686,  0.02753957, -0.07592586, -0.00834088,
         0.02436029,  0.06157847, -0.01084243, -0.00225694, -0.04552547,
         0.03892145, -0.02793127,  0.02379989,  0.0175228 ,  0.05405792,
        -0.01226295, -0.04143437,  0.00405444, -0.06044785,  0.01501426,
         0.03932443, -0.04646767, -0.0909384 ,  0.03138572,  0.02353252,
         0.01818192, -0.05816257,  0.09546108, -0.07378004, -0.01331021,
        -0.02783062,  0.03700425, -0.07186559,  0.01885572, -0.04564153,
         0.02931977,  0.04526908,  0.00266993, -0.01582914, -0.06049008,
         0.01396873, -0.07628307, -0.00444891,  0.01468271,  0.01186184,
         0.02663299, -0.0389335 , -0.04776779,  0.07675266, -0.01926473,
         0.05607224, -0.03774508,  0.07009419, -0.07874078, -0.02701261,
         0.02031058, -0.01844983,  0.05052209,  0.01554742, -0.02748085,
        -0.09926817,  0.01139337,  0.00487999,  0.08193811, -0.02054581,
         0.01267004,  0.03842796, -0.05196651,  0.02440604, -0.0400453 ,
         0.00659692,  0.02624973,  0.07086424, -0.03243198, -0.05721095,
        -0.01691355,  0.01961402, -0.07142837,  0.01243818, -0.02607355,
         0.04392644,  0.05622711, -0.02587781, -0.02604432,  0.00557442,
        -0.02087852,  0.02413453,  0.05194721, -0.05356994, -0.03637878,
        -0.07865983, -0.07636604,  0.00975515,  0.03500509, -0.06980795,
         0.05752264, -0.01673056, -0.0340399 , -0.01278163, -0.04258905,
        -0.01680197, -0.03901863,  0.00869883,  0.06117373, -0.03539309,
        -0.04052648, -0.05507567, -0.02747381,  0.03621771,  0.02183633,
         0.00410252, -0.01824616,  0.03845353, -0.05158651,  0.00703939,
         0.02330739,  0.00160365,  0.04437275, -0.00508688,  0.05168904,
         0.02350485,  0.00503564,  0.07122897, -0.0053331 ,  0.01540706,
        -0.06117442, -0.03550533,  0.00435913, -0.05015754, -0.04695348,
        -0.07823921, -0.00288769,  0.1007337 ,  0.02776407, -0.03429405,
        -0.05200404, -0.03552008, -0.05955734,  0.00157761, -0.02315875,
         0.02564909, -0.01037632,  0.08628542,  0.05433765,  0.03099106,
        -0.0032904 , -0.01085573,  0.05541094, -0.01961383, -0.01851002,
        -0.0205829 ,  0.00288809, -0.04346159, -0.00240653,  0.03098906,
         0.06805943,  0.02392804, -0.00087143,  0.11849838, -0.00662354,
         0.0234806 , -0.05407168,  0.00025006, -0.06506113, -0.03335271,
        -0.01813757, -0.0547736 , -0.05124044,  0.0149815 , -0.03634005,
         0.00955184, -0.01923254, -0.02880512,  0.03761516, -0.02368997,
        -0.00214135, -0.04701069, -0.01904727, -0.00414832,  0.01707188,
        -0.00744127, -0.10671192,  0.01863063,  0.0172092 , -0.01317249,
         0.05507161, -0.02794783, -0.01038573,  0.01369779, -0.02785351,
        -0.00641055,  0.00482977,  0.05791305,  0.00068253, -0.09514807,
        -0.02401415, -0.03764924, -0.03398317, -0.00201889, -0.07095209,
        -0.02382759,  0.02112866, -0.02325487,  0.00396828, -0.01944913,
         0.03205536, -0.00365709, -0.02058569,  0.04140874, -0.01166455,
        -0.00901387, -0.07588132,  0.05523785, -0.01990841,  0.08610331,
         0.03938358, -0.03863108,  0.0619256 , -0.04254428, -0.0060659 ,
         0.04182858,  0.031167  ,  0.06661402, -0.01208028,  0.03386924,
         0.0099611 ,  0.01704327,  0.01766841, -0.02318306,  0.00306054,
        -0.03966992,  0.00824484,  0.05448353, -0.06227463,  0.00953381,
         0.04259429,  0.07594992, -0.00144432, -0.0172962 , -0.00309209,
         0.01782101, -0.04247276, -0.02007676,  0.01732245, -0.01447864,
        -0.03182629, -0.06109937,  0.12389622, -0.0264213 ,  0.12613304,
         0.0529529 , -0.04415898,  0.01228165, -0.07975252, -0.04506217,
         0.09926432, -0.01957092,  0.02383269, -0.00961161,  0.0340592 ,
        -0.01919669,  0.00371576, -0.02047456, -0.00573245, -0.03406498,
         0.10130639, -0.02463348, -0.01652725, -0.04439695,  0.05144096,
        -0.04163115, -0.07009138,  0.03033885,  0.01221655,  0.01122676,
        -0.01824599,  0.04850046,  0.02951283,  0.03386764,  0.01075209,
        -0.07951535, -0.04544162, -0.01712885, -0.00276443, -0.05172772,
        -0.05400492,  0.02210056, -0.02313937, -0.00301713,  0.07361431,
         0.01402689, -0.05849293,  0.06234786,  0.07112302,  0.06102715,
        -0.10060242,  0.02830153,  0.00115053, -0.0276955 , -0.03405289,
         0.05564566,  0.01899233,  0.10814251, -0.06189464, -0.01393861,
        -0.02378333,  0.05661932, -0.02636908, -0.0511329 ,  0.07815224,
        -0.01578249, -0.04091207,  0.03143365,  0.02209224,  0.0100133 ,
        -0.08045664,  0.06243408,  0.08287286, -0.02263854,  0.00598351,
        -0.0204364 ,  0.03002103,  0.0072802 , -0.00554381, -0.00667312,
        -0.02736384, -0.03264644, -0.04029824, -0.02352548,  0.09007895,
         0.00502516,  0.02801224,  0.0537808 ,  0.0499183 ,  0.09447767,
        -0.0342874 , -0.03040084, -0.0171149 ,  0.0887166 , -0.03526124,
         0.01406136,  0.03847755,  0.01271774,  0.05474018,  0.00587571,
         0.00802783, -0.0221112 ,  0.04989271, -0.01755335, -0.03751646,
        -0.05299715, -0.00194388, -0.06408198, -0.05814256,  0.02089712,
         0.01081317, -0.04316043, -0.0612565 ,  0.03288319, -0.05539719,
        -0.03342553,  0.00569095]]

encode1 = [[-5.58560155e-02,  1.03793833e-02,  1.08836126e-03,
         1.17906407e-02,  6.19844941e-04, -1.71196051e-02,
         5.50617650e-03,  2.57632583e-02,  7.79568106e-02,
         1.35374218e-02, -4.26862426e-02, -2.92952061e-02,
         4.38567949e-03,  2.37927423e-03,  4.14524823e-02,
        -5.77454045e-02,  1.71571765e-02,  3.58588137e-02,
        -4.63442393e-02, -3.33043560e-02,  5.89043014e-02,
        -1.89043470e-02,  3.07037588e-02,  4.16139513e-02,
        -4.46102908e-03,  7.39188399e-03,  3.65444385e-02,
        -1.59038790e-02,  8.70581623e-03,  2.50832308e-02,
         3.57893296e-02, -2.61601768e-02,  7.50131756e-02,
        -9.27207898e-03, -7.69961923e-02,  5.59423640e-02,
         3.72149907e-02, -8.23361948e-02,  1.07760467e-02,
         6.64655957e-03,  6.25454262e-02, -3.12933214e-02,
        -9.17728001e-04,  7.02407137e-02,  6.47989288e-02,
         5.22339717e-02,  2.95115523e-02, -1.90094430e-02,
         1.77366734e-02,  2.38351244e-02, -8.18563700e-02,
         1.36629883e-02,  2.24901326e-02,  3.91348749e-02,
         4.36645336e-02,  2.77424082e-02, -4.24532369e-02,
        -9.19169281e-03,  6.63161427e-02, -5.95459752e-02,
        -4.44770642e-02, -4.19546105e-02, -1.59294382e-02,
         1.03449719e-02, -1.67276431e-02,  3.53751704e-02,
         5.57758100e-02,  2.03660602e-04,  1.03772059e-03,
        -1.00044608e-01,  1.87532324e-02, -5.86546548e-02,
        -5.16499616e-02, -4.22034338e-02, -9.51442420e-02,
         1.54425222e-02, -2.91311461e-02, -4.22065193e-03,
         9.18144658e-02, -1.44657120e-02,  4.74967211e-02,
         2.94472035e-02, -4.64991778e-02,  6.21324591e-02,
        -8.35989714e-02,  2.57807858e-02,  5.38657457e-02,
        -6.11187331e-02, -6.53820932e-02,  8.83438736e-02,
        -6.46647140e-02,  1.99843966e-03, -4.39717658e-02,
         5.46029471e-02,  2.95986626e-02, -5.56794778e-02,
         6.22524275e-03,  3.63213271e-02,  7.48022944e-02,
         4.03039530e-02, -6.58372603e-03,  1.48220025e-02,
         4.44185026e-02, -1.47868469e-02,  2.24395152e-02,
         2.31909975e-02, -5.44517152e-02, -5.50606512e-02,
        -1.74878736e-03, -1.85576398e-02, -1.88780320e-03,
        -4.19328883e-02, -5.82432933e-02, -2.03407388e-02,
        -2.48755738e-02, -6.03220332e-03,  1.88276544e-02,
        -5.57436757e-02, -6.91513643e-02,  4.61651944e-02,
        -3.54431830e-02, -7.25724176e-03, -8.77197832e-03,
        -3.70802023e-02,  4.48143948e-03,  1.40532972e-02,
        -5.26780263e-02, -3.36634815e-02,  2.59791501e-02,
         5.12591042e-02,  3.80727574e-02, -5.62282950e-02,
        -4.47284803e-02,  8.21755547e-03, -1.21334307e-02,
        -1.49898382e-03, -7.63684604e-03, -1.38189327e-02,
        -2.84663611e-03,  2.58985553e-02,  1.05062328e-01,
        -1.95367541e-02, -3.08047589e-02, -1.09992200e-03,
         2.38969252e-02,  6.15906855e-03,  2.64255777e-02,
         4.38395888e-02,  3.15245427e-02, -3.49319391e-02,
         4.16921638e-02, -7.91359600e-03, -1.56534445e-02,
         2.36261804e-02,  5.73873669e-02, -4.74780835e-02,
         1.21375010e-03, -1.26404732e-01,  6.22722879e-02,
        -2.09448971e-02,  1.98388230e-02, -2.08288012e-03,
         7.71580311e-03, -7.35445619e-02,  7.05939382e-02,
        -2.79582315e-03, -1.68274976e-02, -3.86280455e-02,
        -1.25327408e-02,  2.27783603e-04,  2.43899077e-02,
         6.16704524e-02,  4.41775285e-02, -5.71403988e-02,
         4.05372158e-02, -5.78060336e-02,  2.12103240e-02,
        -2.06512422e-03, -1.71486288e-02,  3.42617445e-02,
         7.15035647e-02,  1.07118197e-01,  4.35378104e-02,
         2.51225615e-03, -9.98254195e-02,  5.65168783e-02,
         2.61666868e-02,  9.90008656e-03,  1.10188900e-02,
        -1.60355717e-02,  2.61631180e-02,  5.89001663e-02,
        -3.39192040e-02, -8.34639557e-03,  4.07884084e-02,
         7.95165077e-03, -7.60184927e-03,  9.05935764e-02,
        -3.69423144e-02,  4.50941101e-02, -2.52621938e-02,
        -4.66712825e-02,  4.12552878e-02, -2.80125383e-02,
        -4.85979505e-02,  7.52761289e-02, -3.82571593e-02,
        -1.33056892e-02, -9.11031812e-02,  3.58793256e-03,
        -4.78456914e-02,  1.21339392e-02, -2.97553223e-02,
         5.45633398e-02,  6.52453229e-02,  1.72298662e-02,
        -8.63674376e-03, -8.82582292e-02, -2.99916305e-02,
        -2.33768411e-02,  4.58985791e-02,  1.14366915e-02,
         4.14192006e-02, -2.66501289e-02, -3.55945006e-02,
         4.69724908e-02,  7.70609081e-02, -1.99873615e-02,
        -1.38909534e-01, -1.11607742e-02, -4.29180600e-02,
        -3.45343770e-03,  6.41666725e-03, -2.11695377e-02,
         3.08827404e-02, -4.39596325e-02,  3.04377228e-02,
         4.43737619e-02,  8.51960555e-02,  9.23544317e-02,
        -2.84450920e-03,  1.58359352e-02, -4.33856709e-04,
        -1.55558409e-02,  7.24398997e-03, -3.63100097e-02,
        -4.16066162e-02,  3.58262844e-02, -2.13582460e-02,
         6.71671878e-04,  6.55523129e-03, -6.09722286e-02,
         2.82623190e-02,  4.72917743e-02, -5.11269011e-02,
         4.54502963e-02,  3.64827439e-02,  4.25161384e-02,
         4.21955157e-03, -3.04203499e-02,  4.07208176e-03,
         1.88792646e-02, -1.71942562e-02,  3.44712362e-02,
         1.24262720e-02, -3.51582393e-02, -3.56046632e-02,
         1.42781669e-02, -7.16191754e-02,  1.74544808e-02,
        -1.81820709e-02, -1.20467469e-02, -6.52956869e-03,
         6.40068650e-02,  2.39317119e-03,  6.50019571e-03,
        -4.97606695e-02, -7.36028031e-02,  2.01303270e-02,
        -1.10648230e-01, -2.82751527e-02, -6.52976111e-02,
        -3.57194766e-02,  6.01660125e-02,  6.26579672e-02,
        -1.26690017e-02,  4.71823700e-02,  1.74141694e-02,
        -9.15380269e-02, -1.64730307e-02, -3.99642438e-02,
        -4.37727496e-02,  8.32317583e-03,  7.87625741e-03,
         1.37344347e-02,  2.86435452e-03, -4.28341031e-02,
         4.04011272e-03, -2.08696295e-02,  5.60871959e-02,
        -5.20088570e-03,  1.66662447e-02, -3.07582486e-02,
        -4.11115363e-02,  3.13863046e-02,  2.54472299e-03,
         7.28601888e-02,  7.42746219e-02, -3.73042338e-02,
         1.19821345e-02, -1.47419661e-01, -1.71285626e-02,
         2.78499350e-02, -7.51890913e-02, -3.38736400e-02,
        -6.18239725e-03, -9.33924131e-03,  2.43614824e-03,
         3.94226471e-03,  5.08700088e-02,  3.48220170e-02,
        -1.03161350e-01,  2.94661596e-02,  1.59222800e-02,
         2.54841708e-02,  1.68580748e-02,  1.08362157e-02,
        -2.45749652e-02,  1.04032621e-01,  5.61028458e-02,
        -5.97076006e-02,  4.08775061e-02, -6.47986606e-02,
        -4.48565073e-02,  2.38245092e-02,  1.43065397e-02,
        -4.80366312e-02,  5.59653789e-02, -1.38467588e-02,
        -1.21786753e-02, -1.07184695e-02, -9.18465257e-02,
        -3.24542820e-02, -7.27784529e-04, -2.13953014e-02,
        -1.24146238e-01,  4.59451601e-02,  5.82232252e-02,
         6.02944270e-02,  1.15849644e-01, -7.15374574e-03,
        -4.68173102e-02, -4.28641438e-02,  4.15918417e-02,
        -6.89367577e-02, -2.75744107e-02,  3.40521187e-02,
        -2.86052283e-02, -1.29834684e-02,  7.53980502e-02,
         4.28790264e-02,  2.32087560e-02, -1.90235674e-02,
         6.82150275e-02,  7.10849687e-02,  3.73846246e-03,
         2.15770807e-02,  2.48177797e-02,  6.30703662e-03,
         1.07275829e-01,  9.66724567e-03, -2.01598164e-02,
         4.05145474e-02,  1.72853973e-02, -4.59305346e-02,
         3.90707478e-02,  9.13366862e-03,  4.14518453e-03,
        -7.80184343e-02,  3.07381656e-02, -2.14562379e-02,
        -3.29814292e-02,  9.13696140e-02,  4.84822355e-02,
        -3.00200041e-02, -2.81626726e-05, -1.26284137e-02,
         5.13101593e-02,  1.66944135e-02, -8.87953937e-02,
        -4.33718339e-02, -6.42782226e-02,  6.79703988e-03,
        -2.15493385e-02,  7.81479198e-03,  5.70116155e-02,
         4.06016968e-02,  5.67823788e-03, -2.31025796e-02,
         2.77472343e-02, -1.21864947e-02, -4.83479388e-02,
        -6.46434873e-02,  4.53243330e-02,  2.98044663e-02,
         3.40041984e-03,  4.90979366e-02, -3.64368260e-02,
         1.91778550e-03,  9.19434354e-02,  1.18954508e-02,
        -7.77108073e-02, -1.07500991e-02, -8.48027121e-04,
        -1.02724470e-02, -1.94475297e-02, -6.99161692e-03,
         5.16131558e-02, -8.92578214e-02, -5.12765814e-03,
         3.85333784e-02,  3.52962017e-02, -2.73872800e-02,
         3.23636755e-02, -5.38234366e-03, -2.87743434e-02,
        -1.71430204e-02,  6.13022130e-04,  3.31441462e-02,
         5.07791117e-02, -5.61423860e-02, -8.20125043e-02,
         5.35434869e-04, -2.71456391e-02,  3.25847603e-02,
        -3.58145833e-02, -1.01105506e-02, -8.67621787e-03,
         9.18264762e-02, -1.23571306e-02, -2.86376216e-02,
        -6.91498304e-03,  1.52409980e-02, -2.02885084e-02,
        -3.70554104e-02,  1.24070104e-02, -4.46431860e-02,
        -8.23593140e-03, -7.81954899e-02,  1.97167601e-02,
        -1.66755617e-02, -2.80396976e-02,  5.24627082e-02,
        -3.33202593e-02, -1.36394063e-02,  1.04049474e-01,
         2.18499564e-02,  4.83933873e-02,  1.52255567e-02,
         2.69612838e-02, -1.94631447e-03,  6.10304847e-02,
         6.07489534e-02, -2.83648949e-02, -1.86138749e-02,
        -2.75388658e-02, -4.92901132e-02, -1.87180820e-03,
         2.70168739e-03,  7.74147958e-02, -3.21073681e-02,
        -2.99598351e-02, -6.22104621e-03, -4.47825752e-02,
         2.92464700e-02,  7.85585213e-03, -6.70203865e-02,
        -4.73705903e-02,  3.87147185e-03, -5.24458252e-02,
        -7.33931661e-02,  5.64726368e-02,  2.22747475e-02,
        -5.36477566e-02, -1.45399366e-02,  3.17214802e-02,
        -3.89608461e-03, -5.33524081e-02,  8.12088326e-02,
         3.73101532e-02,  3.27487513e-02, -2.32381616e-02,
        -8.36109519e-02, -2.76811477e-02,  5.05519696e-02,
         3.24111991e-02, -3.64606385e-03, -6.05621412e-02,
        -1.19161783e-02, -4.46953289e-02,  4.32259077e-03,
         7.35773444e-02,  6.21400168e-03, -5.11906529e-03,
        -4.37137447e-02,  1.11626387e-02,  8.52970034e-03,
         3.08963768e-02,  8.80825520e-02, -4.02096957e-02,
        -2.61938050e-02, -5.59794493e-02]]


encode2 = [[-0.07697622,  0.03403858,  0.01528058, -0.01377213,  0.00811884,
         0.00259465,  0.08495589, -0.0082644 ,  0.05570962, -0.02813465,
         0.00677514,  0.01513913,  0.00835305,  0.00926556, -0.09028405,
         0.02109325,  0.03495009,  0.05058964,  0.02782562,  0.04676168,
        -0.01991026, -0.0092496 ,  0.05491624, -0.00112209, -0.0661301 ,
         0.03038326,  0.01032968, -0.09027076, -0.02494556,  0.05782467,
         0.0567035 ,  0.02206448,  0.038955  ,  0.00845014,  0.06256976,
         0.0201759 , -0.05632735,  0.02586819, -0.0665793 , -0.0019308 ,
         0.02125601,  0.01118569,  0.00824978,  0.05997382,  0.01196935,
        -0.03947683, -0.00213836,  0.03266066, -0.03282518,  0.02009147,
        -0.00361779, -0.00082794,  0.03552994, -0.07048504,  0.0356421 ,
        -0.01012541,  0.11279305, -0.00053379, -0.0435574 , -0.04125046,
        -0.02359593, -0.02370228, -0.02555467, -0.02071798,  0.09628364,
         0.1087038 ,  0.06988581,  0.02945164,  0.02011682, -0.00224531,
         0.01552526, -0.0108692 ,  0.01217296, -0.0256718 ,  0.02878451,
         0.07213069, -0.0192994 , -0.02992556,  0.05581278, -0.01623787,
        -0.00719999, -0.04249671,  0.06612072, -0.06476074,  0.00076729,
         0.03302084,  0.05990574,  0.01473808,  0.02910518,  0.01382173,
        -0.03465701,  0.06720148, -0.03684765,  0.06365237,  0.00516446,
        -0.02461296, -0.02365438,  0.05196855, -0.01595822,  0.00978132,
        -0.02872795,  0.04234178,  0.00514527, -0.04061963, -0.08728691,
         0.02449292,  0.00440506,  0.00391334, -0.0273306 , -0.06088103,
        -0.04615641, -0.02929708, -0.04416048, -0.02413556, -0.00980822,
        -0.02062364,  0.03849455, -0.00178676, -0.02446324,  0.05772291,
        -0.06109526, -0.00057298,  0.04974294,  0.07004227,  0.00743308,
         0.06606839,  0.00431768,  0.01014765, -0.01917518, -0.03576335,
         0.04156087, -0.06208595, -0.05869344, -0.0020483 , -0.03057797,
         0.14709026, -0.00418136,  0.04372502,  0.0519546 ,  0.05326874,
         0.08481583,  0.04887474,  0.01465231, -0.0125606 , -0.0451933 ,
         0.00524411, -0.02805809,  0.07039988,  0.00845876,  0.0565538 ,
        -0.02008854, -0.02191714,  0.02541985,  0.05103824,  0.01711185,
        -0.07838103,  0.04476156,  0.01969374,  0.03910224, -0.01292338,
         0.05880518,  0.00347624,  0.00938921, -0.07034195,  0.04718211,
        -0.06721131, -0.07667166,  0.02741595,  0.06672077, -0.06505755,
        -0.009961  ,  0.00055282, -0.00178841, -0.0115225 ,  0.02626997,
         0.04148031,  0.01372688,  0.03952959, -0.04642441, -0.02925294,
         0.04100436, -0.037666  ,  0.02559527,  0.01571529,  0.09955174,
        -0.04843972,  0.04936675, -0.00925247, -0.05867129,  0.01257851,
         0.01122854,  0.02002353,  0.03968157,  0.03277422, -0.07355966,
         0.06799182,  0.01642721, -0.06610145,  0.01729989, -0.03340235,
        -0.0140814 ,  0.04535656, -0.05087417,  0.03927606, -0.02764221,
         0.01563899, -0.00422267, -0.04543496, -0.07154258,  0.00450341,
         0.04857033,  0.0520948 , -0.02730566,  0.00979077, -0.05114856,
         0.02785935,  0.02554401,  0.02754616, -0.05368884,  0.00564599,
         0.02581577,  0.0124459 , -0.00939439, -0.09610718, -0.09023177,
         0.01291413,  0.03052477,  0.01301018,  0.01196792, -0.02723337,
        -0.0180521 ,  0.10435647,  0.0539129 ,  0.07914423, -0.00282853,
         0.01390361,  0.01469627, -0.00209937,  0.02555184,  0.12180318,
         0.00326753,  0.06152414, -0.00414686,  0.05696208,  0.00344472,
         0.02616665, -0.09748714, -0.00439344, -0.02807481,  0.05896743,
         0.00669065, -0.08202264,  0.03076056,  0.11659121, -0.05276421,
         0.00272003,  0.04374177, -0.01556802,  0.02175307, -0.0325572 ,
         0.04471117, -0.04821835, -0.02934949,  0.01452505,  0.04905526,
        -0.0119509 , -0.05160873, -0.00079014,  0.04649192, -0.07608162,
         0.02526921,  0.0456837 ,  0.08979273, -0.01177641,  0.01248275,
         0.02763345,  0.04262917, -0.0564537 , -0.08407567,  0.05772386,
         0.0034148 ,  0.08256887,  0.03928296,  0.04440929, -0.08644842,
        -0.06108287,  0.00951437, -0.01837214, -0.06711937, -0.02617029,
         0.08480908, -0.01933345,  0.01632121, -0.05838203,  0.01647952,
         0.03343656, -0.02758787,  0.0133572 ,  0.09291454,  0.0509758 ,
         0.06483598,  0.0176042 , -0.08440321, -0.03713243, -0.01686157,
        -0.03047221,  0.04816782, -0.06932173,  0.0272453 ,  0.00284262,
         0.00557208,  0.01552194, -0.00305924,  0.00856788, -0.09333034,
         0.02969703, -0.06719705, -0.11019224, -0.01241221,  0.0511543 ,
         0.0120886 ,  0.01289063, -0.04131325, -0.02333075,  0.0055985 ,
         0.00709464, -0.00329294,  0.06666325, -0.10264294,  0.00393381,
        -0.05261963,  0.07432026,  0.02995899, -0.02887597, -0.00933895,
         0.03201092,  0.00185881,  0.02557712, -0.01734933,  0.02818744,
        -0.07989348,  0.018835  , -0.07746589,  0.02469931, -0.05731128,
        -0.03218507, -0.05773813,  0.00650335,  0.02249472, -0.02523297,
         0.07345083,  0.04392824,  0.01162973, -0.03695089,  0.05287506,
        -0.04286984, -0.00171958,  0.00331109,  0.02902335,  0.02081216,
         0.00285267,  0.00757799, -0.02373869, -0.05300656, -0.01955651,
         0.09646808, -0.04076819,  0.04915068,  0.00884238, -0.05834352,
        -0.02910499, -0.04046886,  0.03258111,  0.02947227,  0.00954764,
         0.03146087,  0.04934897,  0.03090467, -0.0798027 ,  0.01440997,
        -0.01027634,  0.06296568,  0.02027711,  0.00681274, -0.05856992,
        -0.04427122,  0.06377801, -0.05480863,  0.03603704,  0.04794691,
         0.09478544, -0.01782613,  0.04295071, -0.0170986 ,  0.05139019,
         0.03875536,  0.04356158,  0.02856557,  0.0711389 ,  0.00354841,
        -0.01966618, -0.03383701, -0.02630414, -0.0903888 , -0.03904874,
         0.01733598,  0.00375031, -0.02506596,  0.01226636, -0.05175785,
        -0.03204169, -0.07318694, -0.07243863, -0.00490193,  0.01692216,
         0.03077685, -0.06999456,  0.00156439,  0.03131509, -0.02280487,
         0.01594381,  0.03657867, -0.03613182, -0.03888507, -0.06596357,
        -0.00271628,  0.09370071,  0.03968062, -0.03115505, -0.04137714,
         0.04443656,  0.04190531, -0.02298066,  0.09222029, -0.02898259,
        -0.05025638, -0.01831271,  0.06077041,  0.01780492, -0.05554826,
         0.0101684 , -0.0499866 ,  0.02148656,  0.0357765 , -0.05915959,
         0.01494794,  0.0656104 , -0.00016117, -0.00783719,  0.03329611,
         0.0274953 ,  0.04768238,  0.05216455, -0.07236495,  0.01161857,
         0.03146633, -0.02268336, -0.01190432, -0.03313242, -0.03013377,
         0.04006419,  0.06287574,  0.05337713, -0.019819  , -0.06401096,
        -0.06409851,  0.01846914, -0.02328453,  0.04122601,  0.0173422 ,
         0.01706928,  0.02571439,  0.03798654,  0.01521878, -0.04489183,
         0.04007611,  0.05817826, -0.02605089, -0.02278531, -0.05640218,
        -0.00373744,  0.02820697, -0.02081429,  0.03577268,  0.00986631,
         0.03439987, -0.00885228, -0.04530738,  0.03527985, -0.04624042,
        -0.06211217,  0.07147381,  0.02801303,  0.02652144,  0.02286989,
         0.0190024 ,  0.00678196, -0.03921068, -0.00933776, -0.03305347,
         0.03927357, -0.03510318, -0.00740822, -0.05051938,  0.00478196,
        -0.05674562, -0.03940573, -0.08705325, -0.0544472 ,  0.00409904,
         0.04517418, -0.03214471]]

face0_2d = np.array([face[0]])
face1_2d = np.array([face[1]])
face2_2d = np.array([face[2]])
similarity0 = 1 - float(cdist(face0_2d, encode0, 'cosine'))
if similarity0 > 0.5:
    same_identity = True
    similarity0 = 0.3 * (similarity0 - 0.6) / 0.4 + 0.7
else:
    same_identity = False
    similarity0 = 0.7 * similarity0 / 0.6
print("sim0",round(similarity0 * 100, 2))

similarity1 = 1 - float(cdist(face1_2d, encode1, 'cosine'))
if similarity1 > 0.5:
    same_identity = True
    similarity1 = 0.3 * (similarity1 - 0.6) / 0.4 + 0.7
else:
    same_identity = False
    similarity1 = 0.7 * similarity1 / 0.6
print("sim1",round(similarity1 * 100, 2))

similarity = 1 - float(cdist(face2_2d, encode2, 'cosine'))

if similarity > 0.5:
    same_identity = True
    similarity = 0.3 * (similarity - 0.6) / 0.4 + 0.7
else:
    same_identity = False
    similarity = 0.7 * similarity / 0.6
print("sim2",round(similarity * 100, 2))